---
title: "Group_8_Exploratory_Analysis"
format: html
editor: visual
echo: false
self-contained: true
editor_options: 
  chunk_output_type: inline
---

# Introduction

Time and time again in the UK we see obesity putting more people's lives at risk and more pressure on the NHS. Not only does obesity cause majority health complications but it also puts strain on the NHS's already dwindling budget . So the question arises, is our government doing enough to combat this epidemic?

There is no one solution to cure obesity as many different socio-economic factors play a role in a person's diet and lifestyle. In the following report we shall investigate the change in the prevalence of obesity in Scotland from 2008-2012. As well as determining if obesity rates are influenced by ages, gender, socio-economic status or other lifestyle factor.

We shall conduct a brief exploratory analysis in @sec-EA followed by more rigorous analysis in @sec-FA and with concluding remarks in @sec-C.

# Exploratory Analysis {#sec-EA}

```{r}
#Creating the binary variable for obesity
data <- read.csv('DAProject9.csv')
library(dplyr)
data <- data %>%
  mutate(Obese = ifelse(BMIgroup == "Obese", 1, 0))

```

First, we created a new indicator covariate "Obese" according to the original variable "BMIgroup". As we can see, it was a categorical response variable with four different levels. Our aim was to explore the impact of different factors on obesity, so we use 1 and 0 to separate obese people and other type of people.

```{r}
#Attempting to create the time series plot
data_2008 <- subset(data, Year == '2008' & Obese == 1)
data_2009 <- subset(data, Year == '2009'& Obese == 1)
data_2010 <- subset(data, Year == '2010'& Obese == 1)
data_2011 <- subset(data, Year == '2011'& Obese == 1)
data_2012 <- subset(data, Year == '2012'& Obese == 1)


year <- c(2008, 2009, 2010, 2011, 2012)
no_obese <- c(1448, 1647, 1666, 1620, 1088)

year_obese <- cbind(year, no_obese)
  year_obese <- as.data.frame(year_obese)

as.factor(year_obese$year)

```

Second, we calculated the value of obesity number by year and found each year the number of subjects were different. So we calculated the proportion of prevalence of obesity over year and drew a time series plot pf obese observations from 2008 to 2012 to show whether the proportion of prevalence of obesity in Scotland changed over the years of the Scottish Health Survey.

From @fig-time , we could see that the obesity prevalence proportion first decreased from 2008 to 2009 and got the lowest value 28.78%. Then it increased dramatically and reached its peak value, 30.47% , in 2010. After 2010, it kept decreasing and it got 29.61% in 2012.

```{r}
#| fig-cap: Time Series Plot of Obese Observations Over Time.
#| label: fig-time
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5

library(ggplot2)

#time series plot with proportion of obesity
obesity_by_time=data|>group_by(Year)|>
  summarise(Obesity_Prevalence=mean(Obese==1)*100)
ggplot(obesity_by_time,aes(x=Year,y=Obesity_Prevalence))+
  geom_line()+
  labs(x="Year",y="Percentage of the density")
```

```{r}
#Summary table
summary_by_year <- data %>%
  group_by(Year) %>%
  summarize(Count_Obese = sum(Obese))
summary_by_year

#Histogram of year v counts
ggplot(data = summary_by_year, aes(x = Year, y = Count_Obese)) +
  geom_col(fill='blue') +
  labs(x = "Year", y = "Obese Count",
       title = "Histogram of Obese Count by Year")
```

Third, we wanted to explore the distribution of obesity prevalence in each group of different categorical variables. So we made barplot for each categorical variable, which were age, sex and socio-economic status.

```{r}
#| fig-cap: Proportion of obesity by age groups.
#| label: fig-scat1
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
#barplots of obesity on each covariate
library(dplyr)
# age
obese_age.freq=table(data$AgeGroup)
obese_age.freq=as.data.frame(obese_age.freq)
colnames(obese_age.freq)=c("obese_age","number")
obese_age.freq$proportion=obese_age.freq$number/sum(obese_age.freq$number)

ggplot(data = obese_age.freq, aes(x = obese_age, y = proportion, fill=obese_age)) + geom_col()+
  labs(x="Age Group",y="Proportion of Obesity",title="Proportion of Obesity by Age Group")



```

@fig-scat1 displayed the proportion of obesity over each age group. 45-54 group occupied the highest proportion which was nearly 20% . 16-24 and 75+ groups shared the similar proportion which was approximately 8%.

```{r}
#| fig-cap: Proportion of Obesity by Sex.
#| label: fig-scat2
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
#gender
obese_sex.freq=table(data$Sex)
obese_sex.freq=as.data.frame(obese_sex.freq)
colnames(obese_sex.freq)=c("Sex","number")
obese_sex.freq$proportion=obese_sex.freq$number/sum(obese_sex.freq$number)

ggplot(data = obese_sex.freq, aes(x = Sex, y = proportion, fill=Sex)) + geom_col()+
  labs(x="Sex",y="Proportion of Obesity",title="Proportion of Obesity by Sex")
```

@fig-scat2 displayed the proportion of obesity over sex. Female occupied higher proportion of obesity which was nearly 55% . Male occupied lower proportion of obesity which was nearly 45%.

```{r}
#| fig-cap: Proportion of Obesity by Employment status.
#| label: fig-scat3
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5

#socio-economic status
obese_employment.freq <- table(data$Employment)
obese_employment.freq <- as.data.frame(obese_employment.freq)
obese_employment.freq$Var1 <- as.character(obese_employment.freq$Var1)
obese_employment.freq[3, 1] <- "Employed or on gov't training"

colnames(obese_employment.freq) <- c("obese_employment","number")
obese_employment.freq$proportion <- obese_employment.freq$number/sum(obese_employment.freq$number)


ggplot(data = obese_employment.freq, aes(x = obese_employment, y = proportion, fill=obese_employment)) + 
  geom_col()+
  labs(x="Employment Status",y="Proportion of Obesity",title="Proportion of Obesity by Employment Status")+
  coord_flip()+
    theme(legend.position = "none")

```

@fig-scat3 displayed the proportion of obesity over each socio-economic status. "In paid employment, self-employed or on gov't training" group occupied the highest proportion which was nearly 55.55% . "Doing something else" occupied the lowest proportion which was approximately 1%.
