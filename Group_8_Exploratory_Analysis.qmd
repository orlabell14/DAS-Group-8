---
title: "Group_8_Exploratory_Analysis"
format: html
editor: visual
echo: false
self-contained: true
editor_options: 
  chunk_output_type: inline
---

# Introduction

Time and time again in the UK we see obesity putting more people's lives at risk and more pressure on the NHS. Not only does obesity cause majority health complications but it also puts strain on the NHS's already dwindling budget . So the question arises, is our government doing enough to combat this epidemic?

There is no one solution to cure obesity as many different socio-economic factors play a role in a person's diet and lifestyle. In the following report we shall investigate the change in the prevalence of obesity in Scotland from 2008-2012. As well as determining if obesity rates are influenced by ages, gender, socio-economic status or other lifestyle factor.

We shall conduct a brief exploratory analysis in @sec-EA followed by more rigorous analysis in @sec-FA and with concluding remarks in @sec-C.

# Exploratory Analysis {#sec-EA}

```{r}
#Creating the binary variable for obesity
data <- read.csv('DAProject9.csv')
library(dplyr)
data <- data %>%
  mutate(Obese = ifelse(BMIgroup == "Obese", 1, 0))

```

First, we created a new indicator covariate "Obese" according to the original variable "BMIgroup". As we can see, it was a categorical response variable with four different levels. Our aim was to explore the impact of different factors on obesity, so we use 1 and 0 to separate obese people and other type of people.

```{r}
#Attempting to create the time series plot
data_2008 <- subset(data, Year == '2008' & Obese == 1)
data_2009 <- subset(data, Year == '2009'& Obese == 1)
data_2010 <- subset(data, Year == '2010'& Obese == 1)
data_2011 <- subset(data, Year == '2011'& Obese == 1)
data_2012 <- subset(data, Year == '2012'& Obese == 1)


year <- c(2008, 2009, 2010, 2011, 2012)
no_obese <- c(1448, 1647, 1666, 1620, 1088)

year_obese <- cbind(year, no_obese)
  year_obese <- as.data.frame(year_obese)

as.factor(year_obese$year)

```

Second, we calculated the value of obesity number by year and draw a time series plot pf obese observations from 2008 to 2012 to show whether the prevalence of obesity in Scotland changed over the years of the Scottish Health Survey. From @fig-time , we could see that the obesity prevalence increased from 2008 to 2010 then decreased from 2010 to 2012. It got peak value in 2010 and lowest value in 2012, which was 1666 and 1088 observations respectively. There was a significant increase between 2008 and 2009 and a sharp decrease between 2011 and 2012.

```{r}
#| fig-cap: Time Series Plot of Obese Observations Over Time.
#| label: fig-time
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5

library(ggplot2)
ggplot(year_obese, aes(x = year, y = no_obese)) +
  geom_line() +
  geom_point() +
  labs(title = "Time Series Plot of Obese Observations Over Time",
       x = "Year",
       y = "Number of Observations Obese")
```

```{r}
#Summary table
summary_by_year <- data %>%
  group_by(Year) %>%
  summarize(Count_Obese = sum(Obese))
summary_by_year

#Histogram of year v counts
ggplot(data = summary_by_year, aes(x = Year, y = Count_Obese)) +
  geom_col(fill='blue') +
  labs(x = "Year", y = "Obese Count",
       title = "Histogram of Obese Count by Year")
```

```{r}
#| fig-cap: Proportion of obesity by age groups.
#| label: fig-scat1
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
#barplots of obesity on each covariate
library(dplyr)
# age
obses_age.freq=table(data$AgeGroup)
obses_age.freq=as.data.frame(obses_age.freq)
colnames(obses_age.freq)=c("obses_age","number")
obses_age.freq$proportion=obses_age.freq$number/sum(obses_age.freq$number)

ggplot(data = obses_age.freq, aes(x = obses_age, y = proportion)) + geom_col()+
  labs(x="age group",y="proportion of obesity",title="proportion of obesity by age groups")



```

@fig-scat1 displayed the proportion of obesity over each age group. 45-54 group occupied the highest proportion which was nearly 20% . 16-24 and 75+ groups shared the similar proportion which was approximately 8%.

```{r}
#| fig-cap: Proportion of obesity by sex.
#| label: fig-scat2
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
#gender
obses_sex.freq=table(data$Sex)
obses_sex.freq=as.data.frame(obses_sex.freq)
colnames(obses_sex.freq)=c("obses_sex","number")
obses_sex.freq$proportion=obses_sex.freq$number/sum(obses_sex.freq$number)

ggplot(data = obses_sex.freq, aes(x = obses_sex, y = proportion)) + geom_col()+
  labs(x="sex",y="proportion of obesity",title="proportion of obesity by sex")
```

```{r}
#| fig-cap: Proportion of obesity by employment status.
#| label: fig-scat3
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5

#socio-economic status
obses_employment.freq=table(data$Employment)
obses_employment.freq=as.data.frame(obses_employment.freq)
colnames(obses_employment.freq)=c("obses_employment","number")
obses_employment.freq$proportion=obses_employment.freq$number/sum(obses_employment.freq$number)

ggplot(data = obses_employment.freq, aes(x = obses_employment, y = proportion)) + 
  geom_col()+
  labs(x="employment status",y="proportion of obesity",title="proportion of obesity by employment status")

```
