---
title: "Group_8_Exploratory_Analysis"
format: html
editor: visual
echo: false
self-contained: true
editor_options: 
  chunk_output_type: inline
---

# Introduction

Time and time again in the UK we see obesity putting more people's lives at risk and more pressure on the NHS. Not only does obesity cause majority health complications but it also puts strain on the NHS's already dwindling budget . So the question arises, is our government doing enough to combat this epidemic?

There is no one solution to cure obesity as many different socio-economic factors play a role in a person's diet and lifestyle. In the following report we shall investigate the change in the prevalence of obesity in Scotland from 2008-2012. As well as determining if obesity rates are influenced by ages, gender, socio-economic status or other lifestyle factor.

We shall conduct a brief exploratory analysis in @sec-EA followed by more rigorous analysis in @sec-FA and with concluding remarks in @sec-C.

```{r}
#Creating the binary variable for obesity
data <- read.csv('DAProject9.csv')
library(dplyr)
data <- data %>%
  mutate(Obese = ifelse(BMIgroup == "Obese", 1, 0))

```

```{r}
#Attempting to create the time series plot
data_2008 <- subset(data, Year == '2008' & Obese == 1)
data_2009 <- subset(data, Year == '2009'& Obese == 1)
data_2010 <- subset(data, Year == '2010'& Obese == 1)
data_2011 <- subset(data, Year == '2011'& Obese == 1)
data_2012 <- subset(data, Year == '2012'& Obese == 1)


year <- c(2008, 2009, 2010, 2011, 2012)
no_obese <- c(1448, 1647, 1666, 1620, 1088)

year_obese <- cbind(year, no_obese)
  year_obese <- as.data.frame(year_obese)

as.factor(year_obese$year)

library(ggplot2)
ggplot(year_obese, aes(x = year, y = no_obese)) +
  geom_line() +
  geom_point() +
  labs(title = "Time Series Plot of Obese Observations Over Time",
       x = "Year",
       y = "Number of Observations Obese")
```

```{r}
#Summary table
summary_by_year <- data %>%
  group_by(Year) %>%
  summarize(Count_Obese = sum(Obese))
summary_by_year

#Histogram of year v counts
ggplot(data = summary_by_year, aes(x = Year, y = Count_Obese)) +
  geom_col(fill='blue') +
  labs(x = "Year", y = "Obese Count",
       title = "Histogram of Obese Count by Year")
```

```{r}
#barplots of obesity on each covariate

# age
ggplot(data=data,aes(x=AgeGroup,y=Obese))+
  geom_boxplot(show.legend = FALSE)+
  labs(x="Age group",y="Obesity",title="Obesity on different age groups")

obses_age.freq=table(data$AgeGroup)
obses_age.freq=as.data.frame(obses_age.freq)
colnames(obses_age.freq)=c("obses_age","number")
ggplot(data = obses_age.freq, aes(x = obses_age, y = number)) + geom_col()
#gender
obses_sex.freq=table(data$Sex)
obses_sex.freq=as.data.frame(obses_sex.freq)
colnames(obses_sex.freq)=c("obses_sex","number")
ggplot(data = obses_sex.freq, aes(x = obses_sex, y = number)) + geom_col()

#socio-economic status
obses_employment.freq=table(data$Employment)
obses_employment.freq=as.data.frame(obses_employment.freq)
colnames(obses_employment.freq)=c("obses_employment","number")
ggplot(data = obses_employment.freq, aes(x = obses_employment, y = number)) + geom_col()

```
